local player = game:GetService("Players").LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")

local Truck = workspace:WaitForChild("TruckModel")
local UnloadLocation = workspace:WaitForChild("UnloadZone")
local MineralsFolder = workspace:WaitForChild("Minerals")

local validOres = {
    "Silver", "Bronze", "Nickel", "Iron", 
    "Aluminium", "Coal", "Limestone", 
    "Obsidian", "Ruby", "Copper"
}

local function FindNearestOre()
    local nearestOre = nil
    local shortestDistance = math.huge
    local characterPos = character.PrimaryPart.Position

    for _, ore in ipairs(MineralsFolder:GetChildren()) do
        if table.find(validOres, ore.Name) and ore:IsA("BasePart") then
            local distance = (characterPos - ore.Position).Magnitude
            if distance < shortestDistance then
                nearestOre = ore
                shortestDistance = distance
            end
        end
    end
    return nearestOre
end

local function TeleportTo(target)
    if target and target.Position then
        character:SetPrimaryPartCFrame(CFrame.new(target.Position + Vector3.new(0, 3, 0))
        task.wait(0.5)
    end
end

local function MineOre(ore)
    if ore:FindFirstChild("ProximityPrompt") then
        fireproximityprompt(ore.ProximityPrompt)
        task.wait(2)
    end
end

local function LoadToTruck()
    if Truck and Truck:FindFirstChild("LoadPart") then
        TeleportTo(Truck.LoadPart)
        task.wait(1)
        if Truck:FindFirstChild("ProximityPrompt") then
            fireproximityprompt(Truck.ProximityPrompt)
        end
    end
end

local function UnloadResources()
    TeleportTo(UnloadLocation)
    task.wait(1)
    if UnloadLocation:FindFirstChild("ProximityPrompt") then
        fireproximityprompt(UnloadLocation.ProximityPrompt)
    end
end

-- Główna pętla automatyzacji
while true do
    local nearestOre = FindNearestOre()
    if nearestOre then
        TeleportTo(nearestOre)
        MineOre(nearestOre)
        LoadToTruck()
    else
        UnloadResources()
    end
    task.wait(3)
end
